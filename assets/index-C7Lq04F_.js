(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function i(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=i(o);fetch(o.href,r)}})();class e{static isInitialized=!1;static width=256;static height=512;static scaleX=1;static scaleY=1;static offsetX=0;static cursor={x:-1,y:-1,isPressed:!1,isClicked:!1,isDoubleClicked:!1,lastTimeOfClick:0};static keysList={};static imageList=new Map;static canvasElement=document.querySelector("#app-canvas");static context=e.canvasElement.getContext("2d");constructor(){}static get getWidth(){return e.width}static get getHeight(){return e.height}static get getCursorX(){return e.cursor.x}static get getCursorY(){return e.cursor.y}static get getCursorIsPressed(){return e.cursor.isPressed}static get getCursorIsClicked(){return e.cursor.isClicked}static get getCursorIsDoubleClicked(){return e.cursor.isDoubleClicked}static get getCurrentColor(){return typeof e.context.fillStyle=="string"?e.context.fillStyle:"#000000"}static get getAlpha(){return e.context.globalAlpha}static set setCurrentColor(t){e.context.fillStyle=t}static set setAlpha(t){e.context.globalAlpha=Math.max(0,t)}static set setFontSize(t){e.context.font=`${t}px old-pixel`}static init(){e.isInitialized||(e.isInitialized=!0,e.updateCanvas(),window.addEventListener("resize",e.updateCanvas),e.canvasElement.addEventListener("wheel",t=>t.preventDefault()),e.canvasElement.addEventListener("click",e.handleMouseEvent),e.canvasElement.addEventListener("dblclick",e.handleMouseEvent),e.canvasElement.addEventListener("mousedown",e.handleMouseEvent),e.canvasElement.addEventListener("mousemove",e.handleMouseEvent),e.canvasElement.addEventListener("mouseup",e.handleMouseEvent),e.canvasElement.addEventListener("touchstart",e.handleTouchEvent),e.canvasElement.addEventListener("touchmove",e.handleTouchEvent),e.canvasElement.addEventListener("touchend",e.handleTouchEvent),window.addEventListener("keydown",e.handleKeyEvent),window.addEventListener("keyup",e.handleKeyEvent))}static getIsCursorIntersectWithArea(t,i,s,o){return e.cursor.x>=t&&e.cursor.x<=t+s&&e.cursor.y>=i&&e.cursor.y<=i+o}static updateCursor(){e.cursor.isClicked=!1,e.cursor.isDoubleClicked=!1}static getIsKeyPressed(t){return t==="space"?e.keysList[" "]:e.keysList[t.toLowerCase()]}static clear(){e.context.restore(),e.context.save(),e.context.scale(e.scaleX,e.scaleY),e.context.clearRect(0,0,e.width,e.height)}static fill(t,i,s,o){e.context.fillRect(t,i,s,o)}static print(t,i,s,o,r="left"){e.context.textAlign=r,e.setFontSize=o,e.context.fillText(t,i,s)}static getTextWidth(t,i){return e.setFontSize=i,Math.round(e.context.measureText(t).width)}static loadImage(t,i){return new Promise((s,o)=>{const r=new Image;r.src=i,r.addEventListener("load",()=>s(i)),r.addEventListener("error",()=>o(i)),e.imageList.set(t,r)})}static drawImage(t,i,s,o,r){try{e.context.drawImage(e.imageList.get(t),i,s,o,r)}catch{e.drawUnknownImage(i,s,o,r)}}static drawSprite(t,i,s,o,r,l,L,k,E){try{e.context.drawImage(e.imageList.get(t),i,s,o,r,l,L,k,E)}catch{e.drawUnknownImage(l,L,k,E)}}static drawUnknownImage(t,i,s,o){const r=e.getCurrentColor;e.setCurrentColor="#000000",e.fill(t,i,s/2,o/2),e.fill(t+s/2,i+o/2,s/2,o/2),e.setCurrentColor="#aa00aa",e.fill(t+s/2,i,s/2,o/2),e.fill(t,i+o/2,s/2,o/2),e.setCurrentColor=r}static updateCanvas(){e.canvasElement.width=Math.min(512,document.documentElement.clientWidth),e.canvasElement.height=document.documentElement.clientHeight,e.context.textBaseline="top",e.context.imageSmoothingEnabled=!1,e.scaleX=e.canvasElement.width/e.width,e.scaleY=e.canvasElement.height/e.height,e.offsetX=e.canvasElement.getBoundingClientRect().left}static handleMouseEvent(t){e.cursor.x=Math.trunc((t.pageX-e.offsetX)/e.scaleX),e.cursor.y=Math.trunc(t.pageY/e.scaleY),t.type==="click"&&(e.cursor.isClicked=!0),t.type==="dblclick"?e.cursor.isDoubleClicked=!0:t.type==="mousedown"?e.cursor.isPressed=!0:t.type==="mouseup"&&(e.cursor.isPressed=!1)}static handleTouchEvent(t){t.preventDefault(),t.type!=="touchend"&&(e.cursor.x=Math.trunc((t.touches[t.touches.length-1].pageX-e.offsetX)/e.scaleX),e.cursor.y=Math.trunc(t.touches[t.touches.length-1].pageY/e.scaleY)),t.type==="touchstart"?e.cursor.isPressed=!0:t.type==="touchend"&&(performance.now()-e.cursor.lastTimeOfClick<=500?(e.cursor.isDoubleClicked=!0,e.cursor.lastTimeOfClick=0):e.cursor.lastTimeOfClick=performance.now(),e.cursor.isClicked=!0,e.cursor.isPressed=t.touches.length>0)}static handleKeyEvent(t){t.ctrlKey||t.shiftKey||t.altKey||(e.keysList[t.key.toLowerCase()]=t.type==="keydown")}}const A="/images/game/",Y={background:"backgrounds/background.png","background-without-sign":"backgrounds/background-without-sign.png","leaderboard-background":"backgrounds/leaderboard-background.png","leaderboard-locked-background":"backgrounds/leaderboard-locked-background.png","shop-background":"backgrounds/shop-background.png","question-button":"gui/buttons/question-button.png","leaderboard-button":"gui/buttons/leaderboard-button.png","settings-button":"gui/buttons/settings-button.png","shop-button":"gui/buttons/shop-button.png","home-button":"gui/buttons/home-button.png","pause-button":"gui/buttons/pause-button.png","continue-button":"gui/buttons/continue-button.png","language-button":"gui/buttons/language-button.png","exit-button":"gui/buttons/exit-button.png","exit-locked-button":"gui/buttons/exit-locked-button.png","enable-fullscreen-button":"gui/buttons/enable-fullscreen-button.png","disable-fullscreen-button":"gui/buttons/disable-fullscreen-button.png","telegram-button":"gui/buttons/telegram-button.png","youtube-button":"gui/buttons/youtube-button.png","youtube-locked-button":"gui/buttons/youtube-locked-button.png","controls-button":"gui/buttons/controls-button.png","news-button":"gui/buttons/news-button.png","about-button":"gui/buttons/about-button.png","github-button":"gui/buttons/github-button.png","left-button":"gui/buttons/left-button.png","right-button":"gui/buttons/right-button.png","enable-checkbox-button":"gui/buttons/enable-checkbox-button.png","disable-checkbox-button":"gui/buttons/disable-checkbox-button.png","britain-flag":"gui/flags/britain-flag.png","russia-flag":"gui/flags/russia-flag.png","half-screen-button":"gui/controls/half-screen-button.png","behind-finger-button":"gui/controls/behind-finger-button.png",heart:"gui/hearts/heart.png","gold-heart":"gui/hearts/gold-heart.png","dead-heart":"gui/hearts/dead-heart.png","ice-icon":"gui/icons/ice-icon.png","x2-icon":"gui/icons/x2-icon.png","x3-icon":"gui/icons/x3-icon.png","x4-icon":"gui/icons/x4-icon.png","x5-icon":"gui/icons/x5-icon.png",trophy:"gui/trophy.png",money:"gui/money.png","icon-line":"gui/icon-line.png","group-line":"gui/group-line.png","money-background":"gui/money-background.png","small-money-background":"gui/small-money-background.png","chosen-pizza":"gui/chosen-pizza.png","locked-pizza":"gui/locked-pizza.png",crystal:"gui/crystal.png",clocks:"gui/clocks.png",shop:"gui/shop.png","no-wifi":"gui/no-wifi.png",box:"player/box.png","ice-box":"player/ice-box.png","rotten-box":"player/rotten-box.png",cola:"loot/cola.png","rotten-pizza":"loot/rotten-pizza.png",ice:"loot/ice.png","x-bonus":"loot/x-bonus.png",shield:"loot/shield.png","big-money":"loot/big-money.png","pepperoni-pizza":"loot/pizzas/pepperoni-pizza.png","farmhouse-pizza":"loot/pizzas/farmhouse-pizza.png","margaret-pizza":"loot/pizzas/margaret-pizza.png","cheese-pizza":"loot/pizzas/cheese-pizza.png","spice-pizza":"loot/pizzas/spice-pizza.png","tuscany-pizza":"loot/pizzas/tuscany-pizza.png","carbonara-pizza":"loot/pizzas/carbonara-pizza.png","belarusian-pizza":"loot/pizzas/belarusian-pizza.png","hawaiian-pizza":"loot/pizzas/hawaiian-pizza.png","mexican-pizza":"loot/pizzas/mexican-pizza.png","pumpkin-pizza":"loot/pizzas/pumpkin-pizza.png","italian-pizza":"loot/pizzas/italian-pizza.png","gold-pizza":"loot/pizzas/gold-pizza.png","bavarian-pizza":"loot/pizzas/bavarian-pizza.png","chicken-pizza":"loot/pizzas/chicken-pizza.png","chocolate-pizza":"loot/pizzas/chocolate-pizza.png","pickle-pizza":"loot/pizzas/pickle-pizza.png","casino-pizza":"loot/pizzas/casino-pizza.png","donut-pizza":"loot/pizzas/donut-pizza.png","diamond-pizza":"loot/crystal-pizzas/diamond-pizza.png","ruby-pizza":"loot/crystal-pizzas/ruby-pizza.png","emerald-pizza":"loot/crystal-pizzas/emerald-pizza.png","amethyst-pizza":"loot/crystal-pizzas/amethyst-pizza.png","jade-pizza":"loot/crystal-pizzas/jade-pizza.png","topaz-pizza":"loot/crystal-pizzas/topaz-pizza.png","amber-pizza":"loot/crystal-pizzas/amber-pizza.png","quartz-pizza":"loot/crystal-pizzas/quartz-pizza.png","obsidian-pizza":"loot/crystal-pizzas/obsidian-pizza.png","iron-pizza":"loot/oxidized-pizzas/iron-pizza-stage-0.png","iron-pizza-stage-0":"loot/oxidized-pizzas/iron-pizza-stage-0.png","iron-pizza-stage-1":"loot/oxidized-pizzas/iron-pizza-stage-1.png","iron-pizza-stage-2":"loot/oxidized-pizzas/iron-pizza-stage-2.png","iron-pizza-stage-3":"loot/oxidized-pizzas/iron-pizza-stage-3.png","copper-pizza":"loot/oxidized-pizzas/copper-pizza-stage-0.png","copper-pizza-stage-0":"loot/oxidized-pizzas/copper-pizza-stage-0.png","copper-pizza-stage-1":"loot/oxidized-pizzas/copper-pizza-stage-1.png","copper-pizza-stage-2":"loot/oxidized-pizzas/copper-pizza-stage-2.png","copper-pizza-stage-3":"loot/oxidized-pizzas/copper-pizza-stage-3.png","smell-animation":"animations/smell-animation.png","big-money-animation":"animations/big-money-animation.png"},v={root:A,list:Y};class d{isWorking=!1;nextScene;constructor(){}get getIsWorking(){return this.isWorking}get getNextScene(){return this.nextScene??new P}run(){this.isWorking=!0}stop(t){this.isWorking=!1,this.nextScene=t}init(){}update(t){}draw(t){}}class P extends d{update(){e.getCursorIsClicked&&window.location.reload()}draw(){e.setCurrentColor="#000000",e.fill(0,0,e.getWidth,e.getHeight),e.setCurrentColor="#ffffff",e.print("Empty scene, click for reload app",e.getWidth/2,e.getHeight/2,40,"center")}}const O={english:"Click!",russian:"Кликни!"},S={english:"Loading resources...",russian:"Загрузка ресурсов..."},$={english:"Random pizzas",russian:"Случайные пиццы"},V={english:"Pause",russian:"Пауза"},K={english:"Select the control type",russian:"Выберите тип управления"},q={english:"Half of the screen",russian:"Половина экрана"},U={english:"Behind the finger",russian:"За пальцем"},J={english:"Stickers",russian:"Стикеры"},j={english:"Devblog",russian:"Девблог"},Q={english:"Promo",russian:"Промо"},Z={english:"Developer",russian:"Разработчик"},G={english:"Version",russian:"Версия"},W={click:O,loadingResources:S,randomMode:$,pause:V,changeControls:K,halfScreen:q,behindFinger:U,stickers:J,devblog:j,promo:Q,developer:Z,version:G},b=[{name:"pepperoni",title:{english:"Pepperoni",russian:"Пепперони"},description:{english:"Classic. Everyone knows her.",russian:"Классика. Каждый знает её."},cost:-1},{name:"farmhouse",title:{english:"Farmhouse",russian:"Фермерская"},description:{english:"Pizza for getting a taste of village life.",russian:"Пицца для получения вкуса деревенской жизни."},cost:50},{name:"margaret",title:{english:"Margaret",russian:"Маргарита"},description:{english:"Who doesn't know this pizza?",russian:"Кто не знает эту пиццу?"},cost:150},{name:"cheese",title:{english:"Cheese",russian:"Сырная"},description:{english:"Cheese lovers will like this pizza.",russian:"Любителям сыра придется по вкусу эта пицца."},cost:300},{name:"spice",title:{english:"Spice",russian:"Спайси"},description:{english:"Ahhh! Hot! Hot jalapeno pepper will surprise you.",russian:"Аааа! Горячо! Острый перец халапеньо удивит тебя."},cost:2e3},{name:"tuscany",title:{english:"Tuscany",russian:"Тоскана"},description:{english:"A taste from Florence. It will cover the Renaissance.",russian:"Вкус из Флоренции. Она накроет эпохой возрождения."},cost:700},{name:"carbonara",title:{english:"Carbonara",russian:"Карбонара"},description:{english:"Standard ingredients - delicious pizza.",russian:"Стандартные ингредиенты - вкусная пицца."},cost:300},{name:"belarusian",title:{english:"Belarusian",russian:"Белорусская"},description:{english:"The main ingredient of this pizza is potatoes.",russian:"Главным ингредиентом этой пиццы является картофель."},cost:800},{name:"hawaiian",title:{english:"Hawaiian",russian:"Гавайская"},description:{english:"There are pineapples there, it's terrible!",russian:"Там есть ананасы, ужасно!"},cost:300},{name:"diamond",title:{english:"Diamond",russian:"Алмаз"},description:{english:"Not a single tooth will bite through this pizza.",russian:"Ни один зуб не прокусит эту пиццу."},cost:-1,crystal:!0},{name:"ruby",title:{english:"Ruby",russian:"Рубин"},description:{english:"Is this pizza definitely not fake?",russian:"Эта пицца точно не подделка?"},cost:-1,crystal:!0},{name:"emerald",title:{english:"Emerald",russian:"Изумруд"},description:{english:"Hmm hmm... Hmm.",russian:"Хмм хм... Хммм."},cost:-1,crystal:!0},{name:"mexican",title:{english:"Mexican",russian:"Мексиканская"},description:{english:"Spicey has a worthy rival.",russian:"У Спайси появился достойный соперник."},cost:1200},{name:"pumpkin",title:{english:"Pumpkin",russian:"Тыквенная"},description:{english:"Yes! It's not pizza, but it's definitely not worse.",russian:"Да! Это не пицца, но точно не хуже."},cost:500},{name:"amethyst",title:{english:"Amethyst",russian:"Аметист"},description:{english:"Gutter...",russian:"Желоба..."},cost:-1,crystal:!0},{name:"jade",title:{english:"Jade",russian:"Нефрит"},description:{english:"Straight from the Chinese palaces.",russian:"Прямиком из китайских дворцов."},cost:-1,crystal:!0},{name:"topaz",title:{english:"Topaz",russian:"Топаз"},description:{english:"No! It's not caramel.",russian:"Нет! Это не карамель."},cost:-1,crystal:!0},{name:"italian",title:{english:"Italian",russian:"Итальянская"},description:{english:"Real, Neapolitan pizza.",russian:"Настоящая, Неаполитанская пицца."},cost:1500},{name:"gold",title:{english:"Golden",russian:"Золотая"},description:{english:"Well, very expensive.",russian:"До-до-дорого пиздец."},cost:3e3},{name:"bavarian",title:{english:"Bavarian",russian:"Баварская"},description:{english:"ZHVP didn't come up with a description.",russian:"ЖВП не придумал описание."},cost:1500},{name:"amber",title:{english:"Amber",russian:"Янтарь"},description:{english:"It was once the resin of a tree.",russian:"Когда-то она была смолой дерева."},cost:-1,crystal:!0},{name:"chicken",title:{english:"Chicken Ranch",russian:"Чикен ранч"},description:{english:"6 pizzas and cola.",russian:"6 пицц и кола."},cost:900},{name:"chocolate",title:{english:"Chocolate",russian:"Шоколадная"},description:{english:"Chocolate and pizza? Unusual combination.",russian:"Шоколад и пицца? Необычное сочетание."},cost:500},{name:"pickle",title:{english:"Pickles",russian:"Пикли"},description:{english:"The creator's dream.",russian:"Мечта создателя."},cost:300},{name:"quartz",title:{english:"Quartz",russian:"Кварц"},description:{english:"Turn the taste into a heavenly color!",russian:"Окрась вкус в небесный цвет!"},cost:-1,crystal:!0},{name:"obsidian",title:{english:"Obsidian",russian:"Обсидиан"},description:{english:"Can lose it at night.",russian:"Ночью можно потерять."},cost:-1,crystal:!0},{name:"casino",title:{english:"Chip",russian:"Фишка"},description:{english:"Warning! Highly addictive.",russian:"Внимание! Вызывает сильное привыкание."},cost:1e3},{name:"iron",title:{english:"Iron",russian:"Железная"},description:{english:"Guaranteed to increase the iron level in the body!",russian:"Гарантированно повысит уровень железа в организме!"},cost:2e3,oxidized:!0},{name:"copper",title:{english:"Copper",russian:"Медная"},description:{english:"Great for attracting lightning... maybe.",russian:"Отлично подходит для привлечения молнии... Возможно."},cost:2e3,oxidized:!0},{name:"donut",title:{english:"Donut",russian:"Пончик"},description:{english:"A challenge to all pizza lovers.",russian:"Вызов всем любителям пиццы."},cost:2200}],_=[[{title:{english:"Player",russian:"Игрок"},titleImage:"box",description:{english:"Player - box. Control it to collect as many coins as possible. There are only 3 lives per run, so beware of rotten pizzas.",russian:"Коробка - игрок. Управляй ей чтоб собрать как можно больше монет. Всего 3 жизни на один пробег, поэтому остерегайся гнилых пицц."}},{title:{english:"Record",russian:"Рекорд"},titleImage:"trophy",description:{english:"The result of the run. The longer you live, the bigger the record.",russian:"Результат пробега. Чем дольше живёшь, тем больше рекорд."}},{title:{english:"Money",russian:"Монеты"},titleImage:"money",description:{english:"They are used to buy pizzas. To get them, you need to collect pizzas and big coins.",russian:"Используются для покупки пицц. Чтобы их получить надо собирать пиццы и большие монеты."}}],[{title:{english:"Shop",russian:"Магазин"},titleImage:"shop",description:{english:"A place where you can buy new pizzas and choose the one you want to play with.",russian:"Место, где можно приобрести новые пиццы и выбрать ту, с которой будешь играть."}},{title:{english:"Crystal pizzas",russian:"Кристальные пиццы"},titleImage:"crystal",description:{english:"Crystal pizzas cannot be bought. To purchase them, you need to pick them up at the level. Gives you 100 coins. The chance is 0.1%.",russian:"Кристальные пиццы нельзя купить. Чтобы их приобрести надо подобрать на уровне. Даёт 100 монет. Шанс 0.1%."}},{title:{english:"Metal Pizzas",russian:"Металлические пиццы"},titleImage:"clocks",description:{english:"Metal pizzas rust (oxidize) over time. They change their stage every 100 seconds. There are only 4.",russian:"Металлические пиццы со временем ржавеют (окисляются). Каждые 100 секунд меняют свою стадию. Всего 4."}}],[{title:{english:"Ice",russian:"Лёд"},titleImage:"ice",description:{english:"Freezes the player, slowing him down 3 times. The box freezes for 4 seconds. The chance is 6%.",russian:"Замораживает игрока, замедляя его в 3 раза. Коробка замерзает на 4 секунды. Шанс 6%."}},{title:{english:"Rotten pizza",russian:"Гнилая пицца"},titleImage:"rotten-pizza",description:{english:"Rotten pizza deals damage to the player. It stinks. When selected, the rot effect appears, which gives immunity for 3 seconds. The chance is 20%.",russian:"Гнилая пицца наносит урон игроку. Воняет. При подборе появляется эффект гнили, который даёт иммунитет на 3 секунды. Шанс 20%."}},{title:{english:"Big money",russian:"Большая монета"},titleImage:"big-money",description:{english:"Gives you 100 coins. The chance is 1%.",russian:"Даёт 100 монет. Шанс 1%."}}],[{title:{english:"Shield",russian:"Щит"},titleImage:"shield",description:{english:"Gives you a shield that's ready to take on a rotten pizza. Paints hearts in gold color. When raised again, it gives 30 coins. The chance is 1%.",russian:"Даёт щит, который готов принять на себя гнилую пиццу. Красит сердца в золотой цвет. При повторном поднятии даёт 30 монет. Шанс 1%."}},{title:{english:"Bonus x2",russian:"Бонус х2"},titleImage:"x-bonus",description:{english:"Doubles the amount of coins you receive from the pizza. You can increase the multiplier by picking up another similar bonus during its action. The maximum multiplier is 5. The action time is 14 seconds. The chance is 2%.",russian:"Удваивает количество получаемых монет с пиццы. Можно повысить множитель подобрав ещё один такой же бонус во время его действия. Максимальный множитель 5. Время действия 14 секунд. Шанс 2%."}}]];function X(n){return typeof n=="string"&&(n==="english"||n==="russian")}function tt(n){return typeof n=="string"&&(n==="half-screen"||n==="behind-finger")}class g{static currentLanguage=X(localStorage.getItem("language"))?localStorage.getItem("language"):"english";constructor(){}static get getCurrentLanguage(){return g.currentLanguage}static set setCurrentLanguage(t){g.currentLanguage=t,localStorage.setItem("language",g.currentLanguage)}static getText(t){return t in W?W[t][g.currentLanguage]??"":""}}class I{x;y;constructor(t=0,i=0){this.x=t,this.y=i}get getX(){return this.x}get getY(){return this.y}set(t,i){return this.x=t,this.y=i,this}add(t,i){return this.x+=t,this.y+=i,this}multiply(t){return this.x*=t,this.y*=t,this}clear(){return this.x=0,this.y=0,this}clone(){return new I(this.x,this.y)}}class C{x;y;width;height;velocity=new I;lastTime=0;constructor(t,i,s,o){this.x=t,this.y=i,this.width=s,this.height=o}get getX(){return this.x}get getY(){return this.y}get getWidth(){return this.width}get getHeight(){return this.height}get getVelocity(){return this.velocity}set setX(t){this.x=t}set setY(t){this.y=t}set setWidth(t){this.width=t}set setHeight(t){this.height=t}detectWithAnotherEntity(t){return this.x+this.width>=t.getX&&this.x<=t.getX+t.getWidth&&this.y+this.height>=t.getY&&this.y<=t.getY+t.getHeight}update(t){this.lastTime===0&&(this.lastTime=t),this.x+=this.velocity.getX*((t-this.lastTime)/1e3),this.y+=this.velocity.getY*((t-this.lastTime)/1e3),this.lastTime=t,this.velocity.clear()}draw(t){}}class f extends C{isEnable=!0;isVisible=!0;isIntersected=!1;constructor(t,i,s,o){super(t,i,s,o)}get getIsEnable(){return this.isEnable}get getIsVisible(){return this.isVisible}get getIsIntersected(){return this.isIntersected}get getIsPressed(){return this.isIntersected&&e.getCursorIsPressed}get getIsClicked(){return this.isIntersected&&e.getCursorIsClicked}get getIsDoubleClicked(){return this.isIntersected&&e.getCursorIsDoubleClicked}set setIsEnable(t){this.isEnable=t}set setIsVisible(t){this.isVisible=t}hide(){this.isEnable=!1,this.isVisible=!1}show(){this.isEnable=!0,this.isVisible=!0}update(t){this.isIntersected=this.isEnable&&e.getIsCursorIntersectWithArea(this.getX,this.getY,this.getWidth,this.getHeight)}}class u extends f{imageName;callback;constructor(t,i,s,o,r,l){super(s,o,r,l),this.imageName=t,this.callback=i}get getImageName(){return this.imageName}set setImageName(t){this.imageName=t}update(t){super.update(t),this.getIsEnable&&this.getIsClicked&&this.callback()}draw(t){this.getIsVisible&&e.drawImage(this.imageName,this.getX,this.getY,this.getWidth,this.getHeight)}}function m(n){return n>=1e3?`${Math.trunc(n/1e3)}.${n.toString()[n.toString().length-3]}k`:n.toFixed()}function B(n){const t=Number(localStorage.getItem(n));return Number.isFinite(t)?t:0}function et(n){return localStorage.getItem(n)==="true"}class a{static money=B("money");static highScore=B("high-score");static pizzasList=JSON.parse(localStorage.getItem("pizzas-list")??JSON.stringify({pepperoni:!0}));static controlsType=tt(localStorage.getItem("controls-type"))?localStorage.getItem("controls-type"):"half-screen";static chosenPizza=localStorage.getItem("chosen-pizza")??"pepperoni";static isRandomModeEnabled=et("random-mode");constructor(){}static get getIsMoreThanTwoPizzas(){return Object.values(a.pizzasList).filter(t=>t).length>1}static get getMoney(){return a.money}static get getHighScore(){return a.highScore}static get getControlsType(){return a.controlsType}static get getChosenPizza(){return a.chosenPizza}static get getIsRandomModeEnabled(){return a.isRandomModeEnabled}static set setControlsType(t){a.controlsType=t,localStorage.setItem("controls-type",a.controlsType)}static addMoney(t){a.money+=t,localStorage.setItem("money",a.money.toString())}static updateHighScore(t){a.highScore<t&&(a.highScore=t,localStorage.setItem("high-score",a.highScore.toString()))}static choosePizza(t){a.hasPizza(t)&&(a.chosenPizza=t,localStorage.setItem("chosen-pizza",a.chosenPizza))}static toggleRandomMode(){a.isRandomModeEnabled=!a.isRandomModeEnabled,localStorage.setItem("random-mode",`${a.isRandomModeEnabled}`)}static buyPizza(t,i){a.money>=i&&(a.money-=i,a.pizzasList[t]=!0,localStorage.setItem("money",a.money.toString()),localStorage.setItem("pizzas-list",JSON.stringify(a.pizzasList)))}static hasPizza(t){return a.pizzasList[t]??!1}}class it extends u{pizzaName;pizzaCard;constructor(t,i,s,o,r){super(`${t}-pizza`,()=>s(this.pizzaCard),o,r,64,64),this.pizzaName=t,this.pizzaCard=i}get getPizzaName(){return this.pizzaName}get getPizzaCard(){return this.pizzaCard}update(t){super.update(t),!a.getIsRandomModeEnabled&&this.getIsEnable&&this.getIsDoubleClicked&&a.choosePizza(this.pizzaName)}draw(t){super.draw(t),!a.hasPizza(this.pizzaName)&&e.drawImage("locked-pizza",this.getX,this.getY,this.getWidth,this.getHeight),!a.getIsRandomModeEnabled&&a.getChosenPizza===this.pizzaName&&e.drawImage("chosen-pizza",this.getX,this.getY,this.getWidth,this.getHeight)}}class M extends f{linesList=[];text;fontSize;constructor(t,i,s,o,r){super(s,o,i,0),this.text=t,this.fontSize=r,this.create()}get getText(){return this.text}get getFontSize(){return this.fontSize}set setText(t){this.text=t,this.create()}set setWidth(t){super.setWidth=t,this.create()}set setFontSize(t){this.fontSize=t}draw(t){this.getIsVisible&&this.linesList.forEach((i,s)=>e.print(i,this.getX,this.getY+s*this.fontSize*.7,this.fontSize))}create(){let t="",i=[];this.text.split(" ").forEach(s=>{e.getTextWidth(t+s,this.fontSize)>=this.getWidth?(i=[...i,t],t=s+" "):t+=s+" "}),this.linesList=[...i,t],this.setHeight=Math.ceil(this.linesList.length*this.fontSize*.8)}}class st extends f{pizzaName;title;description;cost;isCrystal;isOxidized;buyButton=new u("",()=>a.buyPizza(this.pizzaName,this.cost),12,264,72,32);constructor(t,i,s,o,r=!1,l=!1){super(0,0,0,0),this.pizzaName=t,this.title=i,this.description=new M(s,e.getWidth/2+32,96,192,30),this.cost=o,this.isCrystal=r,this.isOxidized=l,this.isCrystal&&this.buyButton.hide()}get getPizzaName(){return this.pizzaName}get getTitle(){return this.title}get getDescription(){return this.description.getText}get getIsCrystal(){return this.isCrystal}get getIsOxidized(){return this.isOxidized}update(t){super.update(t),this.buyButton?.update(t)}draw(t){e.drawImage(`${this.pizzaName}-pizza`,16,192,64,64),this.isCrystal&&e.drawImage("crystal",76,175,16,16),this.isOxidized&&e.drawImage("clocks",78,175,16,16),e.setCurrentColor="#ffffff",e.print(this.title,96,160,40),this.description.draw(t),this.cost>=0&&!a.hasPizza(this.pizzaName)&&this.buyButton.getIsVisible&&(e.drawImage("small-money-background",12,264,72,32),e.drawImage("money",12,264,32,32),e.setCurrentColor="#ffffff",e.print(m(this.cost),40,263,32))}}class nt extends d{itemsList=[];rowsCount;currentRowIndex=0;currentRow=[];currentPizzaCard;homeButton=new u("home-button",()=>this.stop(new p),e.getWidth-64-8,8,64,64);leftButton=new u("left-button",()=>this.left(),0,e.getHeight-160,24,64);rightButton=new u("right-button",()=>this.right(),e.getWidth-24,e.getHeight-160,24,64);randomModeCheckbox=new u("disable-checkbox-button",()=>a.toggleRandomMode(),8,e.getHeight-40,32,32);constructor(){super(),this.itemsList=b.map((t,i)=>new it(t.name,new st(t.name,t.title[g.getCurrentLanguage],t.description[g.getCurrentLanguage],t.cost,t.crystal,t.oxidized),s=>this.currentPizzaCard=s,28+Math.floor(i%3)*64+Math.floor(i%3)*4,e.getHeight-160)),this.currentPizzaCard=this.itemsList[0].getPizzaCard,this.rowsCount=Math.floor((this.itemsList.length-1)/3),this.updateRow()}init(){!a.getIsMoreThanTwoPizzas&&this.randomModeCheckbox.hide()}update(t){this.homeButton.update(t),this.randomModeCheckbox.update(t),this.leftButton.update(t),this.rightButton.update(t),this.currentRow.forEach(i=>i?.update(t)),this.currentPizzaCard?.update(t)}draw(t){e.drawImage("shop-background",0,0,e.getWidth,e.getHeight),this.currentRow.forEach(i=>i?.draw(t)),this.currentPizzaCard?.draw(t),this.leftButton.draw(t),this.rightButton.draw(t),e.drawImage("money-background",8,8,88,32),e.drawImage("money",8,8,32,32),e.setCurrentColor="#ffffff",e.print(a.getMoney.toString(),36,7,32),this.randomModeCheckbox.setImageName=`${a.getIsRandomModeEnabled?"enable":"disable"}-checkbox-button`,this.randomModeCheckbox.draw(t),e.setCurrentColor="#ffffff",this.randomModeCheckbox.getIsVisible&&e.print(g.getText("randomMode"),this.randomModeCheckbox.getX+34,this.randomModeCheckbox.getY+4,24),this.homeButton.draw(t)}left(){this.currentRowIndex-1<0?this.currentRowIndex=this.rowsCount:this.currentRowIndex-=1,this.updateRow()}right(){this.currentRowIndex+1>this.rowsCount?this.currentRowIndex=0:this.currentRowIndex+=1,this.updateRow()}updateRow(){this.currentRow=[this.itemsList[this.currentRowIndex*3],this.itemsList[this.currentRowIndex*3+1],this.itemsList[this.currentRowIndex*3+2]]}}class z extends f{buttonsList=[];centerX;margin;buttonSize;constructor(t,i,s,o,r){super(0,s,0,r),this.buttonsList=t.map(l=>new u(l[0],l[1],0,s,r,r)),this.centerX=i,this.margin=o,this.buttonSize=r,this.updateRow()}get getButtonsList(){return this.buttonsList}get getCenterX(){return this.centerX}get getMargin(){return this.margin}set setCenterX(t){this.centerX=t,this.updateRow()}set setMargin(t){this.margin=t,this.updateRow()}hide(){super.hide(),this.buttonsList.forEach(t=>t.hide())}show(){super.show(),this.buttonsList.forEach(t=>t.show())}update(t){super.update(t),this.buttonsList.forEach(i=>i.update(t))}draw(t){this.buttonsList.forEach(i=>i.draw(t))}updateRow(){this.buttonsList.length===2?(this.buttonsList[0].setX=this.centerX-this.buttonSize-this.margin,this.buttonsList[1].setX=this.centerX+this.margin):(this.buttonsList[0].setX=this.centerX-this.buttonSize*1.5-this.margin*2,this.buttonsList[1].setX=this.centerX-this.buttonSize/2,this.buttonsList[2].setX=this.centerX+this.buttonSize/2+this.margin*2),this.setX=this.buttonsList[0].getX,this.setWidth=this.buttonSize*this.buttonsList.length+this.margin*2*(this.buttonsList.length-1)}}class F extends d{buttonsRow=new z([["russia-flag",()=>this.changeLanguage("russian")],["britain-flag",()=>this.changeLanguage("english")]],e.getWidth/2,e.getHeight/2-32,4,64);init(){}update(t){this.buttonsRow.update(t)}draw(t){e.drawImage("background-without-sign",0,0,e.getWidth,e.getHeight),this.buttonsRow.draw(t),e.setCurrentColor="#ffffff",e.print("Русский",this.buttonsRow.getButtonsList[0].getX+32,this.buttonsRow.getButtonsList[0].getY+60,24,"center"),e.print("English",this.buttonsRow.getButtonsList[1].getX+32,this.buttonsRow.getButtonsList[1].getY+60,24,"center")}changeLanguage(t){g.setCurrentLanguage=t,this.stop(new p)}}class ot extends d{halfScreenButton=new u("half-screen-button",()=>this.changeControls("half-screen"),16,152,92,164);behindFingerButton=new u("behind-finger-button",()=>this.changeControls("behind-finger"),e.getWidth-16-92,152,92,164);init(){}update(t){this.halfScreenButton.update(t),this.behindFingerButton.update(t)}draw(t){e.drawImage("background-without-sign",0,0,e.getWidth,e.getHeight),this.halfScreenButton.draw(t),this.behindFingerButton.draw(t),e.setCurrentColor="#ffffff",e.print(g.getText("changeControls"),e.getWidth/2,100,32,"center"),e.print(g.getText("halfScreen"),this.halfScreenButton.getX+this.halfScreenButton.getWidth/2,this.halfScreenButton.getY+this.halfScreenButton.getHeight,24,"center"),e.print(g.getText("behindFinger"),this.behindFingerButton.getX+this.behindFingerButton.getWidth/2,this.behindFingerButton.getY+this.behindFingerButton.getHeight,24,"center")}changeControls(t){a.setControlsType=t,this.stop(new p)}}const at="/pizza-game-client",rt=b.map(({name:n})=>n);b.filter(({crystal:n})=>!n).map(({name:n})=>n);const T=b.filter(({crystal:n})=>n).map(({name:n})=>n),ht=b.filter(({oxidized:n})=>n).map(({name:n})=>n),w={telegram:"https://t.me/onegaf",github:"https://github.com/onegafchik",stickersTelegram:"https://t.me/addstickers/pizzagame",devblog:"https://nektarin.itch.io/pizza-game/devlog"};class gt extends d{githubButton=new u("github-button",()=>window.open(w.github),e.getWidth/2-64-4,70,64,64);telegramButton=new u("telegram-button",()=>window.open(w.telegram),e.getWidth/2+4,70,64,64);homeButton=new u("home-button",()=>this.stop(new D),e.getWidth/2-32,e.getHeight-160,64,64);init(){}update(t){this.githubButton.update(t),this.telegramButton.update(t),this.homeButton.update(t)}draw(t){e.drawImage("background-without-sign",0,0,e.getWidth,e.getHeight),e.setCurrentColor="#ffffff",e.print(g.getText("developer"),e.getWidth/2,8,32,"center"),e.print("NEkTARIN (raro4ka)",e.getWidth/2,40,24,"center"),this.githubButton.draw(t),this.telegramButton.draw(t),this.homeButton.draw(t)}}class D extends d{firstButtonsRow=new z([["language-button",()=>this.stop(new F)],["home-button",()=>this.stop(new p)],["enable-fullscreen-button",()=>this.toggleFullscreen()]],e.getWidth/2,e.getHeight/2-120,4,64);secondButtonsRow=new z([["controls-button",()=>this.stop(new ot)],["about-button",()=>this.stop(new gt)],["exit-locked-button",()=>null]],e.getWidth/2,e.getHeight/2-48,4,64);linkTitlesList=["stickers","devblog","promo"];linkButtonsRow=new z([["telegram-button",()=>window.open(w.stickersTelegram)],["news-button",()=>window.open(w.devblog)],["youtube-locked-button",()=>null]],e.getWidth/2,e.getHeight/2+44,4,64);init(){}update(t){this.firstButtonsRow.update(t),this.secondButtonsRow.update(t),this.linkButtonsRow.update(t)}draw(t){e.drawImage("background-without-sign",0,0,e.getWidth,e.getHeight),this.firstButtonsRow.getButtonsList[2].setImageName=`${document.fullscreenElement?"disable":"enable"}-fullscreen-button`,this.firstButtonsRow.draw(t),this.secondButtonsRow.draw(t),e.drawImage("group-line",24,this.secondButtonsRow.getY+72,208,12),this.linkButtonsRow.draw(t),e.setCurrentColor="#ffffff",this.linkButtonsRow.getButtonsList.forEach((i,s)=>e.print(g.getText(this.linkTitlesList[s]),i.getX+32,i.getY+60,24,"center")),e.print(`${g.getText("version")} ${h.getVersion}`,4,e.getHeight-20,16)}toggleFullscreen(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}}class ut extends d{homeButton=new u("home-button",()=>this.stop(new p),e.getWidth/2-32,e.getHeight-160,64,64);init(){}update(t){this.homeButton.update(t)}draw(t){e.drawImage("background-without-sign",0,0,e.getWidth,e.getHeight),e.drawImage("leaderboard-locked-background",20,24,216,320),this.homeButton.draw(t)}}function x(n,t){return Math.floor(Math.random()*(t-n+1)+n)}function H(n){return Array.from(new Array(n).keys())}class c{isWorking=!1;lastTime=0;deltaTime=0;duration;callback;isLooped;constructor(t,i,s=!1){this.duration=t,this.callback=i,this.isLooped=s}get getIsWorking(){return this.isWorking}get getLastTime(){return this.lastTime}get getDeltaTime(){return this.deltaTime}get getDuration(){return this.duration}get getIsLooped(){return this.isLooped}set setDuration(t){this.duration=Math.max(0,t)}set setIsLooped(t){this.isLooped=t}run(){this.isWorking=!0,this.lastTime=0}stop(){this.isWorking=!1}update(t){this.isWorking&&(this.lastTime===0&&(this.lastTime=t),this.deltaTime=t-this.lastTime,this.deltaTime>=this.duration&&(this.isLooped?this.run():this.stop(),this.callback()))}}class lt extends C{health=3;isFrozen=!1;isHasShield=!1;isHasX=!1;xLevel=2;maxXLevel=5;isRotten=!1;rottenTimer=new c(3e3,()=>this.isRotten=!1);freezeTimer=new c(4e3,()=>this.melt());xTimer=new c(14e3,()=>this.disableX(),!0);defaultSpeed=400;speed=this.defaultSpeed;iconsHash=new Map([["x",this.xTimer],["ice",this.freezeTimer]]);constructor(t,i){super(t,i,64,16)}get getHealth(){return this.health}get getIsFrozen(){return this.isFrozen}get getIsHasShield(){return this.isHasShield}get getIsHasX(){return this.isHasX}get getXLevel(){return this.xLevel}get getIsRotten(){return this.isRotten}set setHealth(t){this.health=Math.max(0,t)}set setIsShield(t){this.isHasShield=t}freeze(){this.isFrozen=!0,this.speed=this.defaultSpeed/3,this.freezeTimer.run()}melt(){this.isFrozen=!1,this.speed=this.defaultSpeed,this.freezeTimer.stop()}enableX(){this.isHasX?this.xLevel=Math.min(this.maxXLevel,this.xLevel+1):(this.isHasX=!0,this.xLevel=2),this.xTimer.run()}disableX(){this.xLevel-=1,this.xLevel<2&&(this.isHasX=!1,this.xTimer.stop())}hit(){if(!this.isRotten){if(this.isHasShield){this.isHasShield=!1;return}this.health=Math.max(0,this.health-1),this.isRotten=!0,this.rottenTimer.run()}}update(t){super.update(t),this.rottenTimer.update(t),this.freezeTimer.update(t),this.xTimer.update(t),(e.getIsKeyPressed("arrowleft")||a.getControlsType==="half-screen"&&e.getCursorIsPressed&&e.getIsCursorIntersectWithArea(0,32,e.getWidth/2,e.getHeight-32)||a.getControlsType==="behind-finger"&&e.getCursorIsPressed&&e.getIsCursorIntersectWithArea(0,32,this.getX+this.getWidth/2-4,e.getHeight-32))&&this.getVelocity.add(-this.speed,0),(e.getIsKeyPressed("arrowright")||a.getControlsType==="half-screen"&&e.getCursorIsPressed&&e.getIsCursorIntersectWithArea(e.getWidth/2,32,e.getWidth/2,e.getHeight-32)||a.getControlsType==="behind-finger"&&e.getCursorIsPressed&&e.getIsCursorIntersectWithArea(this.getX+this.getWidth/2+4,32,e.getWidth,e.getHeight-32))&&this.getVelocity.add(this.speed,0),this.getX<=4&&(this.setX=4),this.getX+this.getWidth>=e.getWidth-4&&(this.setX=e.getWidth-this.getWidth-4)}draw(t){this.isRotten?e.drawImage("rotten-box",this.getX-4,this.getY-48,72,72):e.drawImage(this.isFrozen?"ice-box":"box",this.getX-4,this.getY-48,72,72)}drawHUD(t){H(3).forEach(i=>e.drawImage("dead-heart",i*24,0,32,32)),H(this.health).forEach(i=>e.drawImage(this.isHasShield?"gold-heart":"heart",i*24,0,32,32)),Array.from(this.iconsHash).filter(([i,s])=>s.getIsWorking).forEach(([i,s],o)=>{const r=Math.min(1,1-s.getDeltaTime/s.getDuration);e.drawImage(`${i}${i==="x"?this.xLevel.toString():""}-icon`,0,96+o*48+o*4,56,48),e.drawSprite("icon-line",0,0,r*13,1,0,136+o*48+o*4,r*52,4)})}}class N extends C{type;constructor(t,i,s){super(i,s,64,64),this.type=t}get getType(){return this.type}update(t){super.update(t),this.getVelocity.set(0,300)}draw(t){e.drawImage(this.type,this.getX,this.getY,this.getWidth,this.getHeight)}}class y extends N{name;isOxidized;constructor(t,i,s,o=!1){super(o?"crystal-pizza":"pizza",i,s),this.name=t,this.isOxidized=new Set(ht).has(t)}get getName(){return this.name}get getIsOxidized(){return this.isOxidized}draw(t,i=0){e.drawImage(`${this.name}-pizza${this.isOxidized?`-stage-${i}`:""}`,this.getX,this.getY,this.getWidth,this.getHeight)}}class dt{minDuration;deltaDuration;timer;lootList=[];constructor(t,i,s){this.minDuration=i,this.deltaDuration=s,this.timer=new c(t,()=>this.spawn(),!0)}get getLootList(){return this.lootList}run(){this.timer.run()}stop(){this.timer.stop()}addLoot(t){this.lootList=[...this.lootList,t]}removeLoot(t){this.lootList=this.lootList.filter(i=>i!==t)}clearLootList(){this.lootList=[]}update(t){this.timer.update(t)}spawn(){this.timer.getDuration>this.minDuration&&(this.timer.setDuration=this.timer.getDuration-this.deltaDuration);const t=this.getRandomLootType(),i=x(0,192);t==="pizza"?this.lootList=[...this.lootList,new y(a.getIsRandomModeEnabled?this.getPizzaName(rt,!1):a.getChosenPizza,i,-64)]:t==="crystal-pizza"?this.lootList=[...this.lootList,new y(this.getPizzaName(T,!0),i,-64,!0)]:this.lootList=[...this.lootList,new N(t,i,-64)]}getRandomLootType(){const t=x(1,1e3);switch(!0){case t<=700:return"pizza";case(t>700&&t<=900):return"rotten-pizza";case(t>900&&t<=960):return"ice";case(t>960&&t<=980):return"x-bonus";case(t>980&&t<=990):return"big-money";case(t>990&&t<=999):return"shield";case t==1e3:return T.every(i=>a.hasPizza(i))?"shield":"crystal-pizza";default:return"pizza"}}getPizzaName(t,i){let s=[],o="pepperoni";return t.forEach(r=>{a.hasPizza(r)?!i&&(s=[...s,r]):i&&(s=[...s,r])}),s.length>0&&(o=s[x(0,s.length-1)]),o}}class R{timer;framesList;currentFrame=0;constructor(t,i){this.framesList=i,this.timer=new c(t,()=>this.nextFrame(),!0)}get getIsWorking(){return this.timer.getIsWorking}get getDuration(){return this.timer.getDuration}get getFramesCount(){return this.framesList.length}get getCurrentFrame(){return this.framesList[this.currentFrame]??0}set setDuration(t){this.timer.setDuration=t}run(){this.timer.run()}stop(){this.timer.stop()}reset(){this.currentFrame=0}update(t){this.timer.update(t)}nextFrame(){this.currentFrame>=this.framesList.length-1?this.currentFrame=0:this.currentFrame+=1}}class ct extends d{isPause=!1;bufferTime=0;lastTime=0;player=new lt(0,e.getHeight-92);lootGenerator=new dt(2e3,400,40);score=0;scoreTimer=new c(10,()=>this.score+=1,!0);oxidizedStage=0;maxOxidizedStage=3;oxidizedTimer=new c(1e5,()=>this.oxidizedStage=Math.min(this.oxidizedStage+1,this.maxOxidizedStage),!0);smellAnimation=new R(150,[0,1,2,3]);bigMoneyAnimation=new R(150,[0,1,2,3,4,5,6,7]);pauseButton=new u("pause-button",()=>this.pause(),e.getWidth-32,0,32,32);pauseButtonsRow=new z([["continue-button",()=>this.unpause()],["home-button",()=>this.exit()]],e.getWidth/2,e.getHeight/2-32,4,64);init(){this.pauseButtonsRow.hide(),this.player.setX=e.getWidth/2-this.player.getWidth/2,this.lootGenerator.run(),this.scoreTimer.run(),this.oxidizedTimer.run(),this.smellAnimation.run(),this.bigMoneyAnimation.run()}update(t){this.pauseButton.update(t),this.pauseButtonsRow.update(t),this.isPause?(this.lastTime===0&&(this.lastTime=t),this.bufferTime+=t-this.lastTime,this.lastTime=t):(e.getIsKeyPressed("space")&&this.pause(),this.scoreTimer.update(t-this.bufferTime),this.oxidizedTimer.update(t-this.bufferTime),this.lootGenerator.update(t-this.bufferTime),this.lootGenerator.getLootList.forEach(i=>{if(i.update(t-this.bufferTime),this.player.detectWithAnotherEntity(i)){switch(i.getType){case"pizza":{this.player.getIsHasX?a.addMoney(this.player.getXLevel):a.addMoney(1);break}case"rotten-pizza":{this.player.getIsFrozen&&this.player.melt(),this.player.hit();break}case"ice":{!this.player.getIsRotten&&this.player.freeze();break}case"x-bonus":{this.player.enableX();break}case"big-money":{a.addMoney(100);break}case"shield":{this.player.getIsHasShield&&a.addMoney(30),this.player.setIsShield=!0;break}case"crystal-pizza":{if(!(i instanceof y))return;a.addMoney(100),a.buyPizza(i.getName,0);break}}this.lootGenerator.removeLoot(i)}else i.getY>=e.getHeight&&this.lootGenerator.removeLoot(i)}),this.player.update(t-this.bufferTime),this.player.getHealth<=0&&this.exit())}draw(t){this.smellAnimation.update(t),this.bigMoneyAnimation.update(t),e.drawImage("background",0,0,e.getWidth,e.getHeight),this.player.draw(t),this.player.getIsRotten&&e.drawSprite("smell-animation",this.smellAnimation.getCurrentFrame*16,0,16,32,this.player.getX+4,this.player.getY-64,64,128),this.lootGenerator.getLootList.forEach(i=>{i instanceof y?i.draw(t,this.oxidizedStage):i.draw(t),i.getType==="rotten-pizza"&&e.drawSprite("smell-animation",this.smellAnimation.getCurrentFrame*16,0,16,32,i.getX,i.getY-48,64,128),i.getType==="big-money"&&e.drawSprite("big-money-animation",this.bigMoneyAnimation.getCurrentFrame*16,0,16,16,i.getX,i.getY,64,64)}),this.player.drawHUD(t),e.drawImage("trophy",0,24,32,32),e.setCurrentColor="#ffffff",e.print(a.getHighScore>this.score?`${m(a.getHighScore)} / ${m(this.score)}`:m(this.score),32,24,32),e.drawImage("money",0,48,32,32),e.setCurrentColor="#ffffff",e.print(a.getMoney.toString(),32,48,32),this.isPause&&(e.setCurrentColor="#ffffff",e.print(g.getText("pause"),e.getWidth/2,e.getHeight/2-80,40,"center")),this.pauseButton.draw(t),this.pauseButtonsRow.draw(t)}pause(){this.isPause=!0,this.pauseButton.hide(),this.pauseButtonsRow.show()}unpause(){this.isPause=!1,this.lastTime=0,this.pauseButton.show(),this.pauseButtonsRow.hide()}exit(){this.score>a.getHighScore&&a.updateHighScore(this.score),this.stop(new p)}}class pt extends f{title;titleImage;description;constructor(t,i,s){super(28,0,e.getWidth-56,0),this.title=t,this.titleImage=i,this.description=new M(s,this.getWidth,this.getX,this.getY+32,20),this.setHeight=32+this.description.getHeight}get getTitle(){return this.title}get getTitleImage(){return this.titleImage}get getDescription(){return this.description.getText}set setY(t){super.setY=t,this.description.setY=t+32}draw(t){e.drawImage(this.titleImage,this.getX,this.getY-2,32,32),e.setCurrentColor="#ffffff",e.print(this.title,this.getX+36,this.getY,28),this.description.draw(t)}}class zt extends f{tipBodiesList;constructor(t){super(0,0,0,0),this.tipBodiesList=t.map(i=>new pt(i.title[g.getCurrentLanguage],i.titleImage,i.description[g.getCurrentLanguage])),this.tipBodiesList.reduce((i,s)=>(s.setY=i,i+s.getHeight+20),42)}draw(t){this.tipBodiesList.forEach((i,s)=>{i.draw(t),s<this.tipBodiesList.length-1&&e.drawImage("group-line",24,i.getY+i.getHeight+4,208,12)})}}class ft extends d{tipsList;currentTipIndex=0;leftButton=new u("left-button",()=>this.left(),0,156,24,64);rightButton=new u("right-button",()=>this.right(),e.getWidth-24,156,24,64);homeButton=new u("home-button",()=>this.stop(new p),e.getWidth/2-32,e.getHeight-160,64,64);constructor(){super(),this.tipsList=_.map(t=>new zt(t))}init(){}update(t){this.leftButton.update(t),this.rightButton.update(t),this.homeButton.update(t)}draw(t){e.drawImage("background-without-sign",0,0,e.getWidth,e.getHeight),this.tipsList[this.currentTipIndex].draw(t),this.leftButton.draw(t),this.rightButton.draw(t),this.homeButton.draw(t)}left(){this.currentTipIndex-1<0?this.currentTipIndex=this.tipsList.length-1:this.currentTipIndex-=1}right(){this.currentTipIndex+1>this.tipsList.length-1?this.currentTipIndex=0:this.currentTipIndex+=1}}class p extends d{shopButton=new u("shop-button",()=>this.stop(new nt),8,e.getHeight-160,64,64);topButtonsRow=new z([["question-button",()=>this.stop(new ft)],["leaderboard-button",()=>this.stop(new ut)],["settings-button",()=>this.stop(new D)]],e.getWidth-48,0,0,32);startLevelClickableArea=new u("",()=>this.getNextScene instanceof P&&this.stop(new ct),0,0,e.getWidth,e.getHeight);init(){e.getCursorIsPressed&&(this.startLevelClickableArea.setIsEnable=!1)}update(t){this.shopButton.update(t),this.topButtonsRow.update(t),this.startLevelClickableArea.update(t),!this.startLevelClickableArea.getIsEnable&&!e.getCursorIsPressed&&(this.startLevelClickableArea.setIsEnable=!0)}draw(t){e.drawImage("background",0,0,e.getWidth,e.getHeight),e.setCurrentColor="#ffffff",e.drawImage("trophy",0,0,32,32),e.print(m(a.getHighScore),32,0,32),e.drawImage("money",0,24,32,32),e.print(a.getMoney.toString(),32,24,32),this.shopButton.draw(t),this.topButtonsRow.draw(t),e.setCurrentColor="#ffffff",e.print(g.getText("click"),e.getWidth/2,e.getHeight/2-56,40,"center")}}class mt extends d{isShowImageListDataInConsole=!1;isImageListLoaded=!1;init(){this.loadImageList()}update(t){this.isImageListLoaded&&this.stop(X(localStorage.getItem("language"))?new p:new F)}draw(t){e.setCurrentColor="#000000",e.fill(0,0,e.getWidth,e.getHeight),e.setCurrentColor="#ffffff",!this.isImageListLoaded&&e.print(g.getText("loadingResources"),e.getWidth/2,e.getHeight/2-20,30,"center")}loadImageList(){const t=[];for(const[i,s]of Object.entries(v.list))t.push(e.loadImage(i,`${at}${v.root}${s}`));Promise.allSettled(t).then(i=>{this.isShowImageListDataInConsole&&(console.groupCollapsed("IMAGE LIST"),i.forEach(s=>s.status==="fulfilled"?console.log(`${s.value} - OK`):console.error(`${s.reason} - ERROR`)),console.groupEnd())}).finally(()=>this.isImageListLoaded=!0)}}class h{static version="1.8.4";static loopID;static framesCount=0;static framesPerSecond=0;static isShowFrameDataInConsole=!1;static timerForUpdateFrameData=new c(1e3,()=>h.updateFrameData(),!0);static currentScene=new mt;constructor(){}static get getVersion(){return h.version}static run(){e.init(),h.loopID=window.requestAnimationFrame(t=>h.frame(t)),h.timerForUpdateFrameData.run(),h.currentScene.init(),h.currentScene.run()}static stop(){h.loopID&&window.cancelAnimationFrame(h.loopID)}static frame(t){h.loopID=window.requestAnimationFrame(i=>h.frame(i)),h.framesCount+=1,h.currentScene.getIsWorking||(h.currentScene=h.currentScene.getNextScene,h.currentScene.init(),h.currentScene.run()),h.currentScene.update(t),h.timerForUpdateFrameData.update(t),e.clear(),h.currentScene.draw(t),e.updateCursor()}static updateFrameData(){h.framesPerSecond=h.framesCount,h.framesCount=0}}window.addEventListener("load",h.run);
